{% extends 'base.html' %}
{% load staticfiles %}

{% block content %}
    <form method="POST" id="editForm">
        {% csrf_token %}

        <h3>Email : {{ form.email }}</h3>
        <h3>Username : {{ form.username }}</h3>
        <h3>Password: {{ form.password1 }}</h3>
        <h3>Password Confirmation: {{ form.password2 }}</h3>

        <button type="submit">Submit</button>
    </form>
    <script>
        $('#editForm').submit(function(event){
            event.preventDefault();

            $.ajax({
                type: 'PUT',
                url: '/user/edit/',
                data: {
                    username: $('input[name=username]').val(),
                    password1: $('input[name=password1]').val(),
                    password2: $('input[name=password2]').val(),
                },
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('X-CSRFToken', '{{ csrf_token }}');  
                },
                success: function() {
                    window.location = '/user/signin/';
                },
                error: function(error) {
                    window.location = '/user/edit/'
                }
            })
        });
    </script>
{% endblock %}
